var room_ids={8490:"Barclay",8491:"Orientale",8492:"Louisiane",8493:"Suite Junior",8494:"Lodge",8495:"Pavillon",21546:"Ty Nid",9059056555:"Carte cadeau 100€",9053164897:"Carte cadeau 150€"};bookingRoomDataLayer=function(){var e=[];$("form.room_booked").each((function(t,a){var o={};o.item_id=""+$("input#room_booked_room_id",$(a)).attr("value"),o.item_name=room_ids[$("input#room_booked_room_id",$(a)).attr("value")],o.item_category=$("input#room_booked_arrival_date",$(a)).attr("value")+"-"+$("input#room_booked_departure_date",$(a)).attr("value")+"/"+$("input#room_booked_total_adult",$(a)).attr("value")+" adultes-"+$("input#room_booked_total_children",$(a)).attr("value")+" enfants",o.price=$("input#room_booked_total_price",$(a)).attr("value"),o.promotion_id=$("input#room_booked_pricing_type_id",$(a)).attr("value"),e[t]=o})),window.dataLayer.push({event:"view_item",ecommerce:{currency:"EUR",value:e.length?e[0].price:0,items:e}})},informationsDataLayer=function(e){var t=[],a=$(".informations__header h3").text().replace(/\s+/g," ");$(".informations__room-info").each((function(e,o){var r={};r.item_name=$(".informations__room-name h3",$(o)).text(),r.item_category=a+"/"+$('select[name="cart_item[total_adult]"]',$(o)).val()+" adultes-"+$('select[name="cart_item[total_children]"]',$(o)).val()+" enfants",r.price=$(o).text().match(/\d+ €/)[0],t[e]=r})),window.dataLayer.push({event:e,ecommerce:{currency:"EUR",value:$("#total-price-booking-engine").text(),items:t}})},$(document).ready((function(){$("form.room_booked").on("submit",(function(e){var t=$(e.target[0]).parents("form"),a="add_to_cart",o={price:0};t.attr("action").includes("add-room-to-cart")?(o.item_id=""+$("input#room_booked_room_id",t).attr("value"),o.item_name=room_ids[o.item_id],o.item_category=$("input#room_booked_arrival_date",t).attr("value")+"-"+$("input#room_booked_departure_date",t).attr("value")+"/"+$("input#room_booked_total_adult",t).attr("value")+" adultes-"+$("input#room_booked_total_children",t).attr("value")+" enfants",o.price=$("input#room_booked_total_price",t).attr("value"),o.promotion_id=$("input#room_booked_pricing_type_id",t).attr("value"),o.item_list_id=$('input[name="cart_id"]',t).attr("value")):t.attr("action").includes("add-gift-card-to-cart")?(o.item_id=t.attr("action").match(/\d+/g)[0],o.item_name=room_ids[o.item_id],o.item_category="Carte Cadeau",o.price=o.item_name.match(/\d+/g)[0],o.item_list_id=$('input[name="cart_id"]',t).attr("value")):a="",a&&(window.dataLayer.push({ecommerce:null}),window.dataLayer.push({event:a,ecommerce:{currency:"EUR",value:o.price,items:[o]}}))})),$('form[action*="destroy-cart"]').on("submit",(function(e){var t=$(e.target[0]).parents("form"),a={item_name:"Panier complet",item_list_id:$('input[name="cart_id"]',t).val()};window.dataLayer.push({ecommerce:null}),window.dataLayer.push({event:"remove_from_cart",ecommerce:{items:[a]}})})),$('form[action*="/booking/info-to-cart"]').on("submit",(function(e){if($(".be__not_enough_room_alert").length)return e.preventDefault(),void alert($(".be__not_enough_room_alert").text());var t={};if((t.lead_email=$("input#cart_customer_email").val())&&(t.lead_lastname=$("input#cart_customer_last_name").val())&&(t.lead_firstname=$("input#cart_customer_first_name").val())&&(t.lead_tel=$("input#cart_customer_phone").val())&&$("input#cart_customer_title").val()){t.lead_dates=$(".informations__header h3").text().replace(/\s+/g," ");var a=[];$(".informations__room-info").each((function(e,t){a[e]=$(".informations__room-name h3",$(t)).text()+"("+$('select[name="cart_item[total_adult]"]',$(t)).val()+" adultes-"+$('select[name="cart_item[total_children]"]',$(t)).val()+" enfants)"})),t.lead_rooms=a.toString(),window.dataLayer.push(t)}})),$('a[href*="booking/remove-from-cart"').on("click",(function(e){e.preventDefault();var t=$(e.target).parents(".informations__room-info"),a={item_name:$(".informations__room-name h3",t).text(),item_category:$(".informations__header h3").text().replace(/\s+/g," ")+"/"+$('select[name="cart_item[total_adult]"]',t).val()+" adultes-"+$('select[name="cart_item[total_children]"]',t).val()+" enfants",price:$(".informations__room-info").text().match(/\d+ €/)[0]};window.dataLayer.push({ecommerce:null}),window.dataLayer.push({event:"remove_from_cart",ecommerce:{currency:"EUR",value:$("#total-price-booking-engine").text(),items:[a]}})})),window.location.pathname.match("booking/room")&&(toggleRoomsOnChildren($("#info_total_children").val()>0),reorderRooms(),$("#info_total_children").on("change",(function(){toggleRoomsOnChildren(this.value>0),reorderRooms()})),$("#info_total_adult").on("change",(function(){reorderRooms()})),$(".js__room--pricing-area").each((function(){$('.be__rooms--price:contains("30%")',$(this)).insertAfter($(".be__rooms--price-title",$(this)))})))})),toggleRoomsOnChildren=function(e){$('.be__rooms--card:contains("Barclay")').toggleClass("hide",e),$('.be__rooms--card:contains("Orientale")').toggleClass("hide",e),$('.be__rooms--card:contains("Louisiane")').toggleClass("hide",e),$('.be__rooms--card:contains("Suite")').toggleClass("hide",e),0==$(".be__rooms--card:visible").length?(0==$(".be__no-room-available").length?addNoAvailabilityMessage():$("#near_avail").remove(),checkNearDates(),$(".be__no-room-available").show()):$(".be__no-room-available").hide()},reorderRooms=function(){var e=parseInt($("#info_total_adult").val())+parseInt($("#info_total_children").val());2==e?($(".be__room-select").prepend($('.be__rooms--card:contains("Suite")')),$(".be__room-select").prepend($('.be__rooms--card:contains("Louisiane")')),$(".be__room-select").prepend($('.be__rooms--card:contains("Orientale")')),$(".be__room-select").prepend($('.be__rooms--card:contains("Barclay")'))):3==e?($(".be__room-select").prepend($('.be__room-select--card-title:contains("Pavillon")').parent()),$(".be__room-select").prepend($('.be__room-select--card-title:contains("Lodge")').parent()),$(".be__room-select").prepend($('.be__room-select--card-title:contains("Ty Nid")').parent())):e>=4&&($(".be__room-select").prepend($('.be__room-select--card-title:contains("Pavillon")').parent()),$(".be__room-select").prepend($('.be__room-select--card-title:contains("Lodge")').parent())),$('.be__room-select--card-title:contains("Ty Nid")').parent().toggleClass("hide",4==e&&parseInt($("#info_total_children").val()))},checkNearDates=function(){if($(".be__no-room-available").length){var e=new URLSearchParams(window.location.search),t=e.get("info[arrival_date]"),a=e.get("info[departure_date]"),o=e.get("info[arrival_date]")?new Date(t.replace(/(\d{2})\/(\d{2})\/(\d{4})/g,"$3/$2/$1")):null,r=e.get("info[departure_date]")?new Date(a.replace(/(\d{2})\/(\d{2})\/(\d{4})/g,"$3/$2/$1")):null;if(r||(r=o,o&&r.setDate(o.getDate()+2)),!o||!r)return;var i=new Date;i.setTime(0,0,0,0);var n=(r-o)/864e5;$(".be__no-room-available").prepend('<div class="row" id="near_avail" style="margin: 1.5em 0"></div>'),$("#near_avail").append($("<h4></h4>").text((window.location.pathname.includes("/fr/")?"Autres disponibilités à cette période pour "+$("#info_total_adult").val()+" adultes "+($("#info_total_children").val()>0?$("#info_total_children").val()+" enfants":""):"Other availabilities at this period for "+$("#info_total_adult").val()+" adults "+($("#info_total_children").val()>0?$("#info_total_children").val()+" children":""))+":")),$("#near_avail").append('<div class="col-sm-6 col-md-4" id="near_avail_spinner"><i class="fas fa-spinner fa-spin "></i></div>'),Math.round((o-i)/864e5,0)>2?(o.setDate(o.getDate()-2),r.setDate(r.getDate()-2)):((o=i).setDate(o.getDate()+1),(r=o).setDate(o.getDate()+n));for(let i=1;i<6;i++)o.toLocaleDateString("fr")==t&&r.toLocaleDateString("fr")==a||checkAddNearAvail(e,o,r),o.setDate(o.getDate()+1),o<r&&checkAddNearAvail(e,o,r),r.setDate(r.getDate()+1)}},checkAddNearAvail=function(e,t,a){let o=window.location.pathname.includes("/fr/")?"Du "+t.toLocaleDateString(navigator.language,{dateStyle:"medium"})+" au "+a.toLocaleDateString(navigator.language,{dateStyle:"medium"}):"From "+t.toLocaleDateString(navigator.language,{dateStyle:"medium"})+" to "+a.toLocaleDateString(navigator.language,{dateStyle:"medium"});e.set("info[arrival_date]",t.toLocaleDateString("fr")),e.set("info[departure_date]",a.toLocaleDateString("fr"));let r=window.location.origin+window.location.pathname+"?"+e.toString();$.ajax({url:window.location.origin+window.location.pathname+"?"+e.toString(),beforeSend:function(e){},success:function(e){$("<div></div>").addClass("col-sm-6 col-md-4").append(e.includes('class="be__no-room-available"')?$('<span style="text-decoration: line-through"></span').text(o):$('<a href="'+r+'"></a>').text(o)).insertBefore("#near_avail_spinner"),$("#near_avail_spinner").toggleClass("hide",$("#near_avail>div").length>=10)}})},addNoAvailabilityMessage=function(){window.location.pathname.match("/en/")?$(".be__wrapper").append('            <div class="be__no-room-available" id="no_rooms_available">                <div>                    <p>No accommodation is available for your search.</p>                    <p><br></p>                    <p>If possible, try a search with other dates...</p>                    <p><br></p>                    <p>Remember that in summer, the minimum stay is 2 nights for the guest rooms and 3 nights for the lodgings.</p>                </div>            </div>'):$(".be__wrapper").append('            <div class="be__no-room-available" id="no_rooms_available">                <div>                    <p>Aucun hébergement n\'est disponible pour votre recherche.</p>                    <p><br></p>                    <p>Si possible, essayez une recherche avec d\'autres dates...</p>                    <p><br></p>                    <p>En été, le séjour minimum est de 2 nuits pour les chambres d\'hôtes et 3 nuits pour les gîtes.</p>                </div>            </div>')},checkOccupancyOnInformationSubmit=function(){$('form[action*="/booking/info-to-cart"]').on("submit",(function(e){$(".be__not_enough_room_alert").length&&(e.preventDefault(),alert($(".be__not_enough_room_alert").text()))}))};